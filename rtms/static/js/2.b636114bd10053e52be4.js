webpackJsonp([2],{176:function(e,t,a){a(216);var n=a(72)(a(202),a(227),null,null);e.exports=n.exports},182:function(e,t,a){e.exports={default:a(183),__esModule:!0}},183:function(e,t,a){a(187),e.exports=a(7).Object.assign},184:function(e,t,a){"use strict";var n=a(74),o=a(185),s=a(186),i=a(39),l=a(73),r=Object.assign;e.exports=!r||a(38)(function(){var e={},t={},a=Symbol(),n="abcdefghijklmnopqrst";return e[a]=7,n.split("").forEach(function(e){t[e]=e}),7!=r({},e)[a]||Object.keys(r({},t)).join("")!=n})?function(e,t){for(var a=i(e),r=arguments.length,c=1,d=o.f,u=s.f;r>c;)for(var m,p=l(arguments[c++]),f=d?n(p).concat(d(p)):n(p),v=f.length,h=0;v>h;)u.call(p,m=f[h++])&&(a[m]=p[m]);return a}:r},185:function(e,t){t.f=Object.getOwnPropertySymbols},186:function(e,t){t.f={}.propertyIsEnumerable},187:function(e,t,a){var n=a(20);n(n.S+n.F,"Object",{assign:a(184)})},188:function(e,t,a){e.exports={default:a(189),__esModule:!0}},189:function(e,t,a){var n=a(7),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},202:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(188),o=a.n(n),s=a(182),i=a.n(s);t.default={data:function(){return{current_caseId:0,choose_interface:[],projectList:[],sels:[],total:0,page:1,filters:{name:""},listLoading:!1,addFormVisible:!1,editFormVisible:!1,addLoading:!1,editLoading:!1,executeLoading:!1,executeFormVisible:!1,addFormRules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"}]},addForm:{name:"",flowRemark:"",cards:[{caseId:"",cnt:1,domains:[{step:"",replace:""}]}]}}},mounted:function(){this.projectView(),window.xxx=this},methods:{projectView:function(){var e=this;this.$axios.get("/api/case/").then(function(t){e.choose_interface=t.data.results});var t={page:this.page,name:this.filters.name};this.listLoading=!0,this.$axios.get("/api/flow/",{params:t}).then(function(t){e.total=t.data.count,e.projectList=t.data.results,e.listLoading=!1})},handleCurrentChange:function(e){this.page=e,this.projectView()},interface_select:function(e){console.log("aaaa1111"),console.log(e)},removeDomain:function(e,t){var a=this.addForm.cards[e].domains.indexOf(t);-1!==a&&this.addForm.cards[e].domains.splice(a,1)},removeCard:function(e){var t=this.addForm.cards.indexOf(e);-1!==t&&this.addForm.cards.splice(t,1)},addDomain:function(e){this.addForm.cards[e].domains.push({step:"",replace:"",key:Date.now()})},addCard:function(){this.addForm.cards.push({caseId:"",cnt:1,domains:[{step:"",replace:""}],key:Date.now()})},handleDel:function(e,t){var a=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){a.listLoading=!0;var e="/api/flow/"+t.id+"/";a.$axios.delete(e).then(function(e){a.listLoading=!1,a.$message({message:"删除成功",type:"success"}),a.projectView()})})},handleAdd:function(){this.addFormVisible=!0,this.addForm={name:"",flowRemark:"",cards:[{caseId:"",cnt:1,domains:[{step:"",replace:""}]}]}},handleExecute:function(e,t){var a=this;this.listLoading=!0,this.executeLoading=!0,this.executeFormVisible=!0;var n="/api/flow/"+t.id+"/execute";this.$axios.get(n).then(function(e){a.listLoading=!1,a.executeLoading=!1,a.executeFormVisible=!1,a.$message({message:"执行成功",type:"success"}),a.projectView()})},handleEdit:function(e,t){var a=i()({},t);a.cards=JSON.parse(a.cards),this.editFormVisible=!0,this.addForm=i()({},a)},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.addLoading=!0;var t=i()({},e.addForm);t.cards=o()(t.cards),e.$axios.post("/api/flow/",t).then(function(t){e.addLoading=!1,e.$message({message:"提交成功",type:"success"}),e.addFormVisible=!1,e.$refs.addForm.resetFields(),e.projectView()})})})},editSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0;var t=i()({},e.addForm);t.cards=o()(t.cards);var a="/api/flow/"+t.id+"/";e.$axios.put(a,t).then(function(t){e.editLoading=!1,e.$message({message:"修改成功",type:"success"}),e.editFormVisible=!1,e.projectView()})})})},querySearch:function(e,t){this.$axios.get("/api/flow/").then(function(e){var a=e.data.results;t(a)})},selsChange:function(e){this.sels=e},batchRemove:function(){var e=this,t=this.sels.map(function(e){return e.id}).join(",");this.$confirm("确认删除选中记录吗？","危险",{type:"warning"}).then(function(){e.listLoading=!0,e.$axios.get("/api/flow/batch/?id="+t).then(function(t){if(e.listLoading=!1,t.data.status)e.$message({message:"批量删除成功",type:"success"}),e.projectView();else{var a=t.data.message;e.$message({message:a,type:"error"})}})}).catch(function(){})}}}},211:function(e,t,a){t=e.exports=a(170)(),t.push([e.i,".button{padding:0;float:right;color:#e6091c}.button,.span{font-size:large}","",{version:3,sources:["/home/raoxin/1111/rtms/rtms/frontend/src/modules/app/pages/flow.vue"],names:[],mappings:"AACA,QACI,UAAW,AACX,YAAa,AACb,aAAe,CAElB,AACD,cAFI,eAAiB,CAIpB",file:"flow.vue",sourcesContent:["\n.button {\n    padding: 0;\n    float: right;\n    color: #e6091c;\n    font-size: large;\n}\n.span {\n    font-size: large;\n}\n"],sourceRoot:""}])},216:function(e,t,a){var n=a(211);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(171)("54820758",n,!0)},227:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.filters}},[a("el-form-item",[a("el-input",{model:{value:e.filters.name,callback:function(t){e.filters.name=t},expression:"filters.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",placeholder:"请输入内容"},on:{click:e.projectView}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.projectList,"highlight-current-row":"",border:""},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"flowRemark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){e.handleExecute(t.$index,t.row)}}},[e._v("\n          执行\n        ")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除\n        ")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-button",{attrs:{type:"danger",disabled:0===e.sels.length},on:{click:e.batchRemove}},[e._v("批量删除")]),e._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":15,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新建流程","close-on-click-modal":!1,size:"small"},model:{value:e.addFormVisible,callback:function(t){e.addFormVisible=t},expression:"addFormVisible"}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用例名称"},model:{value:e.addForm.name,callback:function(t){e.addForm.name=t},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"name"}},[a("el-input",{attrs:{placeholder:"备注，非必填"},model:{value:e.addForm.flowRemark,callback:function(t){e.addForm.flowRemark=t},expression:"addForm.flowRemark"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"10px"}},[a("el-button",{attrs:{type:"success"},on:{click:e.addCard}},[e._v("新增步骤")])],1),e._v(" "),e._l(e.addForm.cards,function(t,n){return a("el-card",{key:t.key,staticClass:"box-card"},[a("div",{staticClass:"clearfix",slot:"header"},[a("span",{staticClass:"span",domProps:{innerHTML:e._s("流程"+(n+1))}}),e._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(a){a.preventDefault(),e.removeCard(t)}}},[e._v("\n            删除\n          ")])],1),e._v(" "),a("el-form-item",{attrs:{label:"用例",prop:"cards."+n+".caseId"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:0===e.choose_interface.length},on:{change:function(t){e.interface_select()}},model:{value:t.caseId,callback:function(e){t.caseId=e},expression:"card.caseId"}},e._l(e.choose_interface,function(e){return a("el-option",{attrs:{if:"",label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"次数",prop:"cards."+n+".cnt"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入执行次数"},model:{value:t.cnt,callback:function(e){t.cnt=e},expression:"card.cnt"}})],1)],1),e._v(" "),a("i",{staticClass:"el-icon-plus",on:{click:function(t){e.addDomain(n)}}}),e._v(" "),e._l(t.domains,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:"替换"+(o+1)}},[a("el-col",{attrs:{span:3,offset:0}},[a("el-input",{attrs:{size:"small",placeholder:"step"},model:{value:t.step,callback:function(e){t.step=e},expression:"domain.step"}})],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{size:"small",placeholder:"field"},model:{value:t.replace,callback:function(e){t.replace=e},expression:"domain.replace"}})],1),e._v(" "),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{type:"danger",size:"small",icon:"delete"},on:{click:function(a){a.preventDefault(),e.removeDomain(n,t)}}})],1)],1)})],2)})],2),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑流程","close-on-click-modal":!1,size:"small"},model:{value:e.editFormVisible,callback:function(t){e.editFormVisible=t},expression:"editFormVisible"}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用例名称"},model:{value:e.addForm.name,callback:function(t){e.addForm.name=t},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"name"}},[a("el-input",{attrs:{placeholder:"备注，非必填"},model:{value:e.addForm.flowRemark,callback:function(t){e.addForm.flowRemark=t},expression:"addForm.flowRemark"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"10px"}},[a("el-button",{attrs:{type:"success"},on:{click:e.addCard}},[e._v("新增步骤")])],1),e._v(" "),e._l(e.addForm.cards,function(t,n){return a("el-card",{key:t.key,staticClass:"box-card"},[a("div",{staticClass:"clearfix",slot:"header"},[a("span",{staticClass:"span",domProps:{innerHTML:e._s("流程"+(n+1))}}),e._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(a){a.preventDefault(),e.removeCard(t)}}},[e._v("\n            删除\n          ")])],1),e._v(" "),a("el-form-item",{attrs:{label:"用例",prop:"cards."+n+".caseId"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:0===e.choose_interface.length},on:{change:function(t){e.interface_select(n)}},model:{value:t.caseId,callback:function(e){t.caseId=e},expression:"card.caseId"}},e._l(e.choose_interface,function(e){return a("el-option",{attrs:{if:"",label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"次数",prop:"cards."+n+".cnt"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入执行次数"},model:{value:t.cnt,callback:function(e){t.cnt=e},expression:"card.cnt"}})],1)],1),e._v(" "),a("i",{staticClass:"el-icon-plus",on:{click:function(t){e.addDomain(n)}}}),e._v(" "),e._l(t.domains,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:"替换"+(o+1)}},[e._v("\n          {# :prop=\"'card.domains.' + index + '.replace'+'card.domains.' + index + '.step'\"#}\n          "),a("el-col",{attrs:{span:3,offset:0}},[a("el-input",{attrs:{size:"small",placeholder:"step"},model:{value:t.step,callback:function(e){t.step=e},expression:"domain.step"}})],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{size:"small",placeholder:"field"},model:{value:t.replace,callback:function(e){t.replace=e},expression:"domain.replace"}})],1),e._v(" "),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{type:"danger",size:"small",icon:"delete"},on:{click:function(a){a.preventDefault(),e.removeDomain(n,t)}}})],1)],1)})],2)})],2),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){e.editSubmit(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=2.b636114bd10053e52be4.js.map